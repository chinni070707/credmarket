{% extends 'base.html' %}

{% block content %}
<!-- Hero Carousel Section (Wallapop Style) -->
<div class="bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
        <!-- Carousel Container -->
        <div class="relative rounded-2xl overflow-hidden shadow-lg" id="heroCarousel">
            <!-- Carousel Slides -->
            <div class="carousel-track">
                <!-- Slide 1 -->
                <div class="carousel-slide active bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500">
                    <div class="flex items-center justify-between px-12 py-16">
                        <div class="text-white max-w-2xl">
                            <h2 class="text-5xl font-bold mb-4">Welcome to CredMarket</h2>
                            <p class="text-xl mb-6">India's Most Trusted Marketplace for Corporate Employees</p>
                            <a href="{% url 'listings:listing_list' %}" class="inline-block bg-white text-purple-600 px-8 py-3 rounded-full font-semibold hover:shadow-xl transition-all">
                                Start Browsing ‚Üí
                            </a>
                        </div>
                        <div class="hidden md:block text-8xl">üöÄ</div>
                    </div>
                </div>

                <!-- Slide 2 -->
                <div class="carousel-slide bg-gradient-to-r from-green-400 to-blue-500">
                    <div class="flex items-center justify-between px-12 py-16">
                        <div class="text-white max-w-2xl">
                            <h2 class="text-5xl font-bold mb-4">Verified Users Only</h2>
                            <p class="text-xl mb-6">Buy & Sell with Corporate Email Verification. No Spam!</p>
                            <a href="{% url 'accounts:signup' %}" class="inline-block bg-white text-green-600 px-8 py-3 rounded-full font-semibold hover:shadow-xl transition-all">
                                Join Now ‚Üí
                            </a>
                        </div>
                        <div class="hidden md:block text-8xl">‚úÖ</div>
                    </div>
                </div>

                <!-- Slide 3 -->
                <div class="carousel-slide bg-gradient-to-r from-yellow-400 via-orange-500 to-red-500">
                    <div class="flex items-center justify-between px-12 py-16">
                        <div class="text-white max-w-2xl">
                            <h2 class="text-5xl font-bold mb-4">Sell Anything</h2>
                            <p class="text-xl mb-6">Furniture, Electronics, Books & More. List in 2 Minutes!</p>
                            <a href="{% url 'listings:create_listing' %}" class="inline-block bg-white text-orange-600 px-8 py-3 rounded-full font-semibold hover:shadow-xl transition-all">
                                Post Free Ad ‚Üí
                            </a>
                        </div>
                        <div class="hidden md:block text-8xl">üí∞</div>
                    </div>
                </div>
            </div>

            <!-- Navigation Arrows -->
            <button class="carousel-btn prev" onclick="moveSlide(-1)">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="carousel-btn next" onclick="moveSlide(1)">
                <i class="fas fa-chevron-right"></i>
            </button>

            <!-- Dots Indicator -->
            <div class="carousel-dots">
                <span class="dot active" onclick="currentSlide(0)"></span>
                <span class="dot" onclick="currentSlide(1)"></span>
                <span class="dot" onclick="currentSlide(2)"></span>
            </div>
        </div>
    </div>
</div>

<!-- Stats Section -->
<div class="bg-gray-50 py-12">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="grid grid-cols-3 gap-8 text-center">
            <div>
                <div class="text-4xl font-bold text-gray-900 mb-2">{{ total_users|default:"10,000+" }}</div>
                <div class="text-gray-600 font-medium">Verified Users</div>
            </div>
            <div>
                <div class="text-4xl font-bold text-gray-900 mb-2">{{ approved_companies_count|default:"100+" }}</div>
                <div class="text-gray-600 font-medium">Top Companies</div>
            </div>
            <div>
                <div class="text-4xl font-bold text-gray-900 mb-2">{{ active_listings|default:"5,000+" }}</div>
                <div class="text-gray-600 font-medium">Active Listings</div>
            </div>
        </div>
    </div>
</div>

<!-- Categories Section -->
<div class="bg-white py-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <h2 class="text-3xl font-bold text-gray-900 mb-8">Popular Categories</h2>
        <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
            {% for category in categories %}
            <a href="{% url 'listings:listing_list' %}?category={{ category.id }}" 
               class="bg-white border-2 border-gray-200 rounded-xl p-6 text-center hover:border-purple-500 hover:shadow-lg transition-all group">
                <div class="text-4xl mb-3">{{ category.icon|default:"üì¶" }}</div>
                <div class="text-gray-900 font-semibold group-hover:text-purple-600">{{ category.name }}</div>
                <div class="text-sm text-gray-500 mt-1">{{ category.listing_count|default:0 }}</div>
            </a>
            {% empty %}
            <!-- Default categories if none exist -->
            <a href="{% url 'listings:listing_list' %}?category=electronics" class="bg-white border-2 border-gray-200 rounded-xl p-6 text-center hover:border-purple-500 hover:shadow-lg transition-all">
                <div class="text-4xl mb-3">üì±</div>
                <div class="text-gray-900 font-semibold">Electronics</div>
            </a>
            <a href="{% url 'listings:listing_list' %}?category=furniture" class="bg-white border-2 border-gray-200 rounded-xl p-6 text-center hover:border-purple-500 hover:shadow-lg transition-all">
                <div class="text-4xl mb-3">üõãÔ∏è</div>
                <div class="text-gray-900 font-semibold">Furniture</div>
            </a>
            <a href="{% url 'listings:listing_list' %}?category=books" class="bg-white border-2 border-gray-200 rounded-xl p-6 text-center hover:border-purple-500 hover:shadow-lg transition-all">
                <div class="text-4xl mb-3">üìö</div>
                <div class="text-gray-900 font-semibold">Books</div>
            </a>
            <a href="{% url 'listings:listing_list' %}?category=fashion" class="bg-white border-2 border-gray-200 rounded-xl p-6 text-center hover:border-purple-500 hover:shadow-lg transition-all">
                <div class="text-4xl mb-3">üëî</div>
                <div class="text-gray-900 font-semibold">Fashion</div>
            </a>
            <a href="{% url 'listings:listing_list' %}?category=sports" class="bg-white border-2 border-gray-200 rounded-xl p-6 text-center hover:border-purple-500 hover:shadow-lg transition-all">
                <div class="text-4xl mb-3">‚öΩ</div>
                <div class="text-gray-900 font-semibold">Sports</div>
            </a>
            <a href="{% url 'listings:listing_list' %}?category=other" class="bg-white border-2 border-gray-200 rounded-xl p-6 text-center hover:border-purple-500 hover:shadow-lg transition-all">
                <div class="text-4xl mb-3">üéÅ</div>
                <div class="text-gray-900 font-semibold">Others</div>
            </a>
            {% endfor %}
        </div>
    </div>
</div>

<!-- Recent Listings -->
<div class="bg-gray-50 py-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center mb-8">
            <h2 class="text-3xl font-bold text-gray-900">Latest Listings</h2>
            <a href="{% url 'listings:listing_list' %}" class="text-purple-600 font-semibold hover:text-purple-700">
                View All ‚Üí
            </a>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-6">
            {% for listing in recent_listings %}
            <a href="{% url 'listings:listing_detail' listing.id %}" class="bg-white rounded-xl overflow-hidden shadow-sm hover:shadow-xl transition-all group">
                {% if listing.image %}
                <div class="aspect-square overflow-hidden bg-gray-100">
                    <img src="{{ listing.image.url }}" alt="{{ listing.title }}" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-300">
                </div>
                {% else %}
                <div class="aspect-square bg-gradient-to-br from-purple-100 to-pink-100 flex items-center justify-center">
                    <span class="text-6xl">üì¶</span>
                </div>
                {% endif %}
                <div class="p-4">
                    <div class="text-2xl font-bold text-gray-900 mb-2">‚Çπ{{ listing.price }}</div>
                    <h3 class="font-semibold text-gray-900 mb-2 line-clamp-1">{{ listing.title }}</h3>
                    <div class="text-sm text-gray-500">
                        <i class="fas fa-map-marker-alt mr-1"></i>{{ listing.location|default:"India" }}
                    </div>
                </div>
            </a>
            {% empty %}
            <div class="col-span-full text-center text-gray-500 py-12">
                No listings yet. Be the first to post!
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<!-- Carousel JavaScript -->
<style>
.carousel-track {
    position: relative;
    width: 100%;
    height: 350px;
}

.carousel-slide {
    position: absolute;
    width: 100%;
    height: 100%;
    opacity: 0;
    transition: opacity 0.5s ease-in-out;
}

.carousel-slide.active {
    opacity: 1;
}

.carousel-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(255, 255, 255, 0.9);
    border: none;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    cursor: pointer;
    font-size: 20px;
    color: #6366f1;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    transition: all 0.3s;
    z-index: 10;
}

.carousel-btn:hover {
    background: white;
    box-shadow: 0 8px 12px rgba(0, 0, 0, 0.2);
}

.carousel-btn.prev {
    left: 20px;
}

.carousel-btn.next {
    right: 20px;
}

.carousel-dots {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 12px;
    z-index: 10;
}

.dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.5);
    cursor: pointer;
    transition: all 0.3s;
}

.dot.active {
    background: white;
    width: 32px;
    border-radius: 6px;
}
</style>

<script>
let currentSlideIndex = 0;
let autoPlayInterval;

function showSlide(index) {
    const slides = document.querySelectorAll('.carousel-slide');
    const dots = document.querySelectorAll('.dot');
    
    if (index >= slides.length) currentSlideIndex = 0;
    if (index < 0) currentSlideIndex = slides.length - 1;
    
    slides.forEach(slide => slide.classList.remove('active'));
    dots.forEach(dot => dot.classList.remove('active'));
    
    slides[currentSlideIndex].classList.add('active');
    dots[currentSlideIndex].classList.add('active');
}

function moveSlide(direction) {
    currentSlideIndex += direction;
    showSlide(currentSlideIndex);
    resetAutoPlay();
}

function currentSlide(index) {
    currentSlideIndex = index;
    showSlide(index);
    resetAutoPlay();
}

function autoPlay() {
    currentSlideIndex++;
    showSlide(currentSlideIndex);
}

function resetAutoPlay() {
    clearInterval(autoPlayInterval);
    autoPlayInterval = setInterval(autoPlay, 5000);
}

// Initialize
showSlide(currentSlideIndex);
autoPlayInterval = setInterval(autoPlay, 5000);

// Pause on hover
document.getElementById('heroCarousel').addEventListener('mouseenter', () => {
    clearInterval(autoPlayInterval);
});

document.getElementById('heroCarousel').addEventListener('mouseleave', () => {
    autoPlayInterval = setInterval(autoPlay, 5000);
});
</script>

{% endblock %}
