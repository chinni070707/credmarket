{% extends 'base.html' %}

{% block title %}{{ company.name }} Listings - CredMarket{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8">
    <!-- Header -->
    <div class="bg-gradient-to-r from-purple-600 to-indigo-600 rounded-xl shadow-lg p-6 sm:p-8 mb-6 sm:mb-8 text-white">
        <div class="flex items-center space-x-4">
            <div class="w-12 h-12 sm:w-16 sm:h-16 bg-white/20 rounded-full flex items-center justify-center">
                <i class="fas fa-building text-2xl sm:text-3xl"></i>
            </div>
            <div>
                <h1 class="text-2xl sm:text-3xl font-bold">{{ company.name }}</h1>
                <p class="text-sm sm:text-base text-purple-100 mt-1">Listings from your colleagues</p>
            </div>
        </div>
    </div>

    <!-- Stats Bar -->
    <div class="bg-white rounded-lg shadow p-4 mb-6 grid grid-cols-2 sm:grid-cols-3 gap-4 text-center">
        <div>
            <div class="text-2xl sm:text-3xl font-bold text-purple-600">{{ listings.count }}</div>
            <div class="text-xs sm:text-sm text-gray-600">Active Listings</div>
        </div>
        <div>
            <div class="text-2xl sm:text-3xl font-bold text-green-600">{{ listings|length }}</div>
            <div class="text-xs sm:text-sm text-gray-600">From Colleagues</div>
        </div>
        <div class="col-span-2 sm:col-span-1">
            <div class="text-2xl sm:text-3xl font-bold text-blue-600">100%</div>
            <div class="text-xs sm:text-sm text-gray-600">Verified</div>
        </div>
    </div>

    <!-- Listings Grid -->
    {% if listings %}
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 sm:gap-6">
        {% for listing in listings %}
        <a href="{% url 'listings:listing_detail' listing.slug %}" class="group">
            <div class="bg-white rounded-xl shadow-md overflow-hidden card-hover h-full flex flex-col">
                <!-- Image -->
                <div class="relative h-48 sm:h-56 bg-gray-200 overflow-hidden">
                    {% if listing.get_primary_image %}
                        <img src="{{ listing.get_primary_image.image.url }}" alt="{{ listing.title }}" class="w-full h-full object-cover group-hover:scale-110 transition duration-300">
                    {% else %}
                        <div class="w-full h-full flex items-center justify-center bg-gradient-to-br from-green-100 to-emerald-100">
                            <i class="fas fa-image text-4xl sm:text-5xl text-gray-300"></i>
                        </div>
                    {% endif %}
                    
                    <!-- Badges -->
                    <div class="absolute top-2 left-2 bg-white px-2 py-1 rounded-full text-xs font-semibold shadow-md">
                        {{ listing.category.name }}
                    </div>
                    
                    {% if listing.seller.company %}
                    <div class="absolute top-2 right-2 bg-purple-600 text-white px-2 py-1 rounded-full text-xs font-semibold shadow-md">
                        <i class="fas fa-building mr-1"></i>{{ listing.seller.company.name }}
                    </div>
                    {% endif %}
                    
                    {% if listing.is_negotiable %}
                    <div class="absolute bottom-2 left-2 bg-blue-600 text-white px-2 py-1 rounded-full text-xs font-bold shadow-md">
                        <i class="fas fa-check-circle mr-1"></i> Negotiable
                    </div>
                    {% else %}
                    <div class="absolute bottom-2 left-2 bg-gray-600 text-white px-2 py-1 rounded-full text-xs font-bold shadow-md">
                        <i class="fas fa-times-circle mr-1"></i> Non-Negotiable
                    </div>
                    {% endif %}
                </div>
                
                <!-- Content -->
                <div class="p-4 flex-1 flex flex-col">
                    <h3 class="font-bold text-gray-900 mb-2 line-clamp-2 text-sm sm:text-base">{{ listing.title }}</h3>
                    <div class="mt-auto">
                        <div class="text-xl sm:text-2xl font-bold text-green-600 mb-2">â‚¹{{ listing.price }}</div>
                        <div class="flex items-center justify-between text-xs sm:text-sm text-gray-500">
                            <div class="flex items-center space-x-1">
                                <i class="fas fa-user text-purple-600"></i>
                                <span class="truncate">{{ listing.seller.get_display_name }}</span>
                            </div>
                            <span><i class="fas fa-eye mr-1"></i>{{ listing.views_count }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </a>
        {% endfor %}
    </div>
    {% else %}
    <!-- Empty State -->
    <div class="text-center py-12 sm:py-16">
        <i class="fas fa-box-open text-6xl sm:text-7xl text-gray-300 mb-4"></i>
        <h3 class="text-xl sm:text-2xl font-bold text-gray-700 mb-2">No Listings Yet</h3>
        <p class="text-sm sm:text-base text-gray-500 mb-6">Be the first from {{ company.name }} to post a listing!</p>
        <a href="{% url 'listings:create_listing' %}" class="btn-primary text-white px-6 py-3 rounded-full font-semibold inline-flex items-center space-x-2">
            <i class="fas fa-plus-circle"></i>
            <span>Create Listing</span>
        </a>
    </div>
    {% endif %}
</div>
{% endblock %}
